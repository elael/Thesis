%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TRAJ1


\begin{simulation}
\label{sim::zebra_traj1}
\end{simulation}

\noindent Considere novamente o manipulador antropomórfico Zebra-ZERO, porém sem atuação nas últimas 3 juntas. Desta forma, configura-se um caso 3DoF, não redundante para posição ${\bf p}\!\in\!\mathbb{R}^3$. Inicialmente será avaliado o desempenho do algoritmo proposto para a Trajetória \ref{trajze1}, livre e afastada de singularidades (Figura \ref{fig::zebra_traj1}). 

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 0cm 0cm 0cm 0cm, scale = 0.39]{sim/zebra_traj1.eps}&
\includegraphics[trim = 0cm 0cm 2cm 0cm, scale = 0.39]{sim/zebra_traj1_2.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj1}: manipulador Zebra-ZERO e trajetória desejada em perspectiva e visão superior.}
\label{fig::zebra_traj1}
\end{figure}

Os resultados obtidos para ${\bf q}(0) = [0\;{\pi}/2\;-\pi]$, ${\boldsymbol \Theta}(0) = {\bf 0}$, $\Lambda = 2\,{\bf I}$ e $\Gamma = {\bf I}$ são apresentados a seguir e comparados com os obtidos pelo algoritmo DLS ($\delta_0 = 3\cdot10^2$ e $\omega_0 = 10^3$). Como esperado, os dois métodos possibilitaram o rastreamento com erro praticamente nulo. As trajetórias efetuadas e as normas dos erros de posição são mostradas nas Figuras \ref{fig::cartesiano_1} e \ref{fig::zebra1_data}.a, respectivamente. 

\begin{figure}[!htb]
\includegraphics[trim = 0cm 0cm 0cm 0cm, scale = 0.39]{sim/zebra/traj1/cartesiano.eps}
\caption{Simulação \ref{sim::zebra_traj1}: trajetórias no espaço cartesiano.}
\label{fig::cartesiano_1}
\end{figure}

\newpage
\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj1/norm.eps}\\
\includegraphics[trim = 2.7cm 0cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj1/cond.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj1}: (a) norma do erro e (b) número de condicionamento.}
\label{fig::zebra1_data}
\end{figure}

O número de condicionamento $c = \sigma_{min}({\bf J}\,{\bf J}^T)/\sigma_{max}({\bf J}\,{\bf J}^T)$ é mostrado na Figura \ref{fig::zebra1_data}.b e evidencia o fato de que a trajetória desejada esta afastada de configurações singulares. Desta forma, $\delta = 0$ para todo tempo $t$. A Figura \ref{fig::zebra1_dataq} apresenta as variáveis $\dot{\bf q}$ e ${\bf q}$ obtidas. 

\begin{figure}[!htb]
\includegraphics[trim = 2.35cm 0cm 2.6cm 0cm, scale = 0.49]{sim/zebra/traj1/dataq.eps}
\caption{Simulação \ref{sim::zebra_traj1}: variáveis (a) $\dot{\bf q}_{IF}$; (b) $\dot{\bf q}_{DLS}$; (c) ${\bf q}_{IF}$; e (d) ${\bf q}_{DLS}$}.
\label{fig::zebra1_dataq}
\end{figure}

Note que os resultados são praticamente coincidentes e que as velocidades das juntas permanecem numa faixa adequada, abaixo de 0.2 rad/s após o transitório.  





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TRAJ2
\newpage
\begin{simulation}
\label{sim::zebra_traj2}
\end{simulation}

\noindent Considera-se agora uma trajetória que apresenta singularidades internas, isto é, configurações singulares que pertencem ao espaço de trabalho do manipulador robótico. A trajetória considerada (Trajetória \ref{trajze2}) apresenta 3 pontos de singularidade de ombro, como evidenciado na Figura \ref{fig::zebra_traj2}. 

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 0cm 0cm 0cm 2cm, scale = 0.39]{sim/zebra_traj2.eps}&
\includegraphics[trim = 0cm 0cm 2cm 0cm, scale = 0.39]{sim/zebra_traj2_2.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj2}: manipulador Zebra-ZERO e trajetória desejada em perspectiva e visão frontal.}
\label{fig::zebra_traj2}
\end{figure}

As trajetórias desenvolvidas são mostradas nas Figuras \ref{fig::cartesiano_2} e \ref{fig::zebra2_plane}. Nota-se que, para os ganhos considerados, o algoritmo proposto apresentou um desempenho superior ao método DLS, permitindo o rastreamento da trajetória desejada com erro praticamente nulo, inclusive em configurações singulares. As normas dos erros de posição e os números de condicionamento são apresentados na Figura \ref{fig::zebra2_data}.

\begin{figure}[!htb]
\centering
\includegraphics[trim = 1.8cm 0cm 0cm 0cm, scale = 0.39]{sim/zebra/traj2_1/cartesiano.eps}
\caption{Simulação \ref{sim::zebra_traj2}: trajetórias no espaço cartesiano.}
\label{fig::cartesiano_2}
\end{figure}

\newpage
\begin{figure}[!htb]
\centering
\includegraphics[trim = 2.35cm 0.5cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj2_1/plane.eps}\\
\caption{Simulação \ref{sim::zebra_traj2}: trajetórias no plano $yz$.}
\label{fig::zebra2_plane}
\end{figure}

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj2_1/norm.eps}\\
\includegraphics[trim = 2.7cm 0cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj2_1/norm_amp.eps}\\
\includegraphics[trim = 2.7cm 0.5cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj2_1/cond.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj2}: (a) norma do erro; (b) norma do erro (escala ampliada); e (c) número de condicionamento.}
\label{fig::zebra2_data}
\end{figure}

\newpage

As variáveis $\dot{\bf q}$ e ${\bf q}$ obtidas são apresentadas na Figura \ref{fig::zebra2_dataq}. Note que as velocidades das juntas obtidas com a inversa filtrada são mais suaves, uma vez que não há o chaveamento de um termo de amortecimento. 
 
\begin{figure}[!htb]
\includegraphics[trim = 2.35cm 0cm 2.6cm 0.3cm, scale = 0.49]{sim/zebra/traj2_1/dataq_amp_only.eps}
\caption{Simulação \ref{sim::zebra_traj2}: variáveis (a) $\dot{\bf q}_{IF}$; (b) $\dot{\bf q}_{DLS}$; (c) ${\bf q}_{IF}$; e (d) ${\bf q}_{DLS}$}
\label{fig::zebra2_dataq}
\end{figure}

Em configurações de pouca manipulabilidade, onde o termo de amortecimento é adicionado, a convergência da inversa filtrada também se torna mais lenta, visto que estas configurações estão associadas a um ou mais valores singulares pequenos. A Figura \ref{fig::zebra2_delta} apresenta a variável de amortecimento $\delta$ e o valor da função $V_c$, havendo uma similaridade entre ambos os sinais.

\begin{figure}[!htb]
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0cm 2.6cm 0cm, scale = 0.49]{sim/zebra/traj2_1/vc.eps}\\
\includegraphics[trim = 2.7cm 0.3cm 2.6cm 0cm, scale = 0.49]{sim/zebra/traj2_1/delta.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj1}: (a) função $V_c$ e (b) $\delta$.}
\label{fig::zebra2_delta}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TRAJ 2 - condicao 2
\newpage
Para uma condição inicial ${\bf q}(0) = [0\;(\pi/2-0.1)\;-(\pi/2-0.1)]$, dentro da região de pouca manipulabilidade definida por $\omega_0$, o algoritmo DLS apresenta desempenho pouco satisfatório, sendo incapaz de rastrear a posicao desejada (Figuras \ref{fig::cartesiano_22} e \ref{fig::zebra22_data}). Neste caso, a variável $\delta > 0$ para todo tempo $t$ (Figura \ref{fig::zebra22_delta}), garantindo uma solução viável porém pouca precisa.
 
\begin{figure}[!htb]
\centering
\includegraphics[trim = 0cm 0.5cm 0cm 0.5cm, scale = 0.39]{sim/zebra/traj2_2/cartesiano.eps}
\caption{Simulação \ref{sim::zebra_traj2}b: trajetórias no espaço cartesiano.}
\label{fig::cartesiano_22}
\end{figure}

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0.2cm 2.7cm 1cm, scale = 0.49]{sim/zebra/traj2_2/norm.eps}\\
\includegraphics[trim = 2.7cm 0.1cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/traj2_2/cond.eps}\\
\includegraphics[trim = 2.7cm 0.2cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/traj2_2/delta.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj2}b: (a) norma do erro; (b) condicionamento; e (c) $\delta$.}
\label{fig::zebra22_data}
\end{figure}

%\begin{figure}[!htb]
%\includegraphics[trim = 2.35cm 0.2cm 2.6cm 0.8cm, scale = 0.49]{sim/zebra/traj2_2/delta.eps}
%\caption{Legend}
%\label{fig::zebra22_delta}
%\end{figure}











%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TRAJ 3
\newpage
\begin{simulation}
\label{sim::zebra_traj3}
\end{simulation}
\noindent Neste caso, analisa-se o desempenho dos métodos para um caso extremo, em que trechos da trajetória desejada não pertencem ao espaço de trabalho do manipulador, de forma que o erro não pode ser anulado. A trajetória considerada (Trajetória \ref{trajze3}) é similar à considerada na simulação \ref{sim::zebra_traj1}, porém deslocada no eixo $x$.

%\noindent In this case, we analyze the performance of the methods for an extreme case, in which part of the desired trajectory
%is outside the workspace of the manipulator, so that the error cannot be cancelled. A trajetória considera (Trajetória \ref{trajze3}) é similar to trajectory I but shifted in the positive xaxis. 

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 0cm 0cm 0cm 0cm, scale = 0.39]{sim/zebra_traj3.eps}&
\includegraphics[trim = 0cm 0cm 2cm 0cm, scale = 0.39]{sim/zebra_traj3_2.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj3}: manipulador Zebra-ZERO e trajetória desejada em perspectiva e visão superior.}
\label{fig::zebra_traj3}
\end{figure}

As Figuras \ref{fig::cartesiano_3} e \ref{fig::zebra3_plane} apresentam as trajetórias desenvolvidas no espaço cartesiano. As normas dos erros e as medidas de manipulabilidade são apresentadas na Figura \ref{fig::zebra3_data}. Ambos os algoritmos permitem o rastreamento da parcela viável da trajetória desejada. Porém, em determinados instantes, esta se torna inalcançável e ambos os algoritmos levam o manipulador à configurações próximas de singularidades. 

%The norms of the errors and manipulability measures
%are presented in Figure 8. Both algorithms allow the tracking
%of the viable part of the trajectory. But at some point, the
%desired trajectory becomes unreachable and both methods
%lead the manipulator to configurations near singularities.

\begin{figure}[!htb]
\centering
\includegraphics[trim = 1.8cm 0cm 0cm 0cm, scale = 0.39]{sim/zebra/traj3_1/cartesiano.eps}
\caption{Simulação \ref{sim::zebra_traj3}: trajetórias no espaço cartesiano.}
\label{fig::cartesiano_3}
\end{figure}

\newpage
\begin{figure}[!htb]
\centering
\includegraphics[trim = 2.35cm 0.5cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj3_1/plane.eps}\\
\caption{Simulação \ref{sim::zebra_traj3}: trajetórias no plano $xy$.}
\label{fig::zebra3_plane}
\end{figure}

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj3_1/norm.eps}\\
\includegraphics[trim = 2.7cm 0cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj3_1/norm_amp.eps}\\
\includegraphics[trim = 2.7cm 0.5cm 2.7cm 0cm, scale = 0.49]{sim/zebra/traj3_1/cond.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj3}: (a) norma do erro; (b) norma do erro (escala ampliada); e (c) número de condicionamento.}
\label{fig::zebra3_data}
\end{figure}

\newpage

As variáveis $\dot{\bf q}$ e ${\bf q}$ obtidas são apresentadas na Figura \ref{fig::zebra3_dataq}. Nos trechos em que a trajetória se torna não factível, a utilização da inversa filtrada resultou em oscilações indesejadas nas velocidades das juntas e, consequentemente, na posição do efetuador. O algoritmo DLS, por sua vez, resultou em picos de velocidade na vizinhança da região de chaveamento de $\delta$. 

\begin{figure}[!htb]
\includegraphics[trim = 2.35cm 0.5cm 2.6cm 0.9cm, scale = 0.49]{sim/zebra/traj3_1/dataq.eps}
\caption{Simulação \ref{sim::zebra_traj3}: variáveis (a) $\dot{\bf q}_{IF}$; (b) $\dot{\bf q}_{DLS}$; (c) ${\bf q}_{IF}$; e (d) ${\bf q}_{DLS}$}
\label{fig::zebra3_dataq}
\end{figure}

Nota-se também que, uma vez que a trajetória é novamente alcançável, o método DLS apresenta um desvio considerável. Este desvio pode ser atribuído ao fato de que o chaveamento é realizado com base em medidas de manipulabilidade, isto é, elipsóides no espaço operacional. Os sinais $V_c$ e $\delta$ são mostrados na Figura \ref{fig::zebra3_delta}.
 
\begin{figure}[!htb]
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0cm 2.6cm 0.2cm, scale = 0.49]{sim/zebra/traj3_1/vc.eps}\\
\includegraphics[trim = 2.7cm 0.3cm 2.6cm 0cm, scale = 0.49]{sim/zebra/traj3_1/delta.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj3}: (a) função $V_c$ e (b) $\delta$.}
\label{fig::zebra3_delta}
\end{figure}

\newpage

Na Figura \ref{fig::zebra32_plane} são apresentadas as trajetórias obtidas com o método da inversa filtrada para um trecho não factível e diferentes ganhos ${\boldsymbol \Gamma} = \gamma\,{\bf I}$.  

\begin{figure}[!htb]
\centering
\includegraphics[trim = 2.35cm 0.2cm 2.7cm 0.2cm, scale = 0.49]{sim/zebra/traj3_2/cartesiano.eps}\\
\caption{Simulação \ref{sim::zebra_traj3}: trecho não factível e diferentes ganhos $\gamma$.}
\label{fig::zebra32_plane}
\end{figure}

O ganho $\gamma$ utilizado está diretamente relacionado ao desempenho do algoritmo proposto e quanto maior este ganho, menor será a amplitude das oscilações observadas no espaço operacional. Porém, ao analisar as variáveis $\dot{\bf q}$ desenvolvidas a nível de juntas, se verifica também um aumento considerável na frequência das oscilações, geralmente inviáveis e indesejadas em aplicações práticas. A Figura \ref{fig::zebra32_dataq} apresenta as velocidades e as variáveis de juntas obtidas para $\gamma = 25$. 
 
\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0.1cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/traj3_2/qdot.eps}\\
\includegraphics[trim = 2.7cm 0.1cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/traj3_2/q.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_traj3}: variáveis (a) $\dot{\bf q}_{IF}$ e (b) ${\bf q}_{IF}$ para $\gamma = 25$.} 
\label{fig::zebra32_dataq}
\end{figure}
