\newpage
\section{Lei de Controle Modificada}

Considere inicialmente o ganho escalar $k$ e sua função inversa $k^{-1}$. A inversa é uma função ímpar de $k$ e, portanto, possui o mesmo sinal do ganho $k$. Porém, esta igualdade de sinal não é verificada para a inversa filtrada $\theta$. %A Figura \ref{fig:dyntheta} abaixo ilustra uma curva típica no plano $\theta \times k$ para um ganho $k$ evoluindo do semi-plano positivo para o negativo.
%
%Consider the scalar gain $k$ and its inverse function $k^{-1}$. The inverse is an odd function of $k$, that is, it has the same sign of $k$. The same is not verified for the function $k$ and its filtered inverse $\theta$. Figure \ref{fig:cartesiano1} below illustrates a typical curve in $\theta \times k$ plane for a gain $k$ evolving from the positive to the negative half-plan.
%
%\begin{figure}[!htb]
%  \centering
%  \includegraphics[width=70mm]{siso_smp.eps}
%  \caption{Plane $\theta \times k$ (curva típica).}
% \label{fig:evolk1}
%\end{figure}
%
%
%\begin{figure}[htpb]
%\centering
%\def\JPicScale{0.5}%0.65
%{\small
%\begin{tabular}{cc}
%\input{fig/evol1.pst}& \qquad \qquad
%\input{fig/evol2.pst}
%\end{tabular}
%}
%\caption{Plano $\theta \times k$ (curva típica).}
%\label{fig:dyntheta}
%\end{figure}
%
%%% Assuming $\dot{k} < \infty$, it can be stated that $ \partial \theta/\partial k = 0$ for $S = 0$ or $k = 0$, defining different curves of "exit" ($k$ approaching $0$) and "arrival" ($S$ approaching $0$). Note that $\theta$ isn't an odd function of $k$, and, soon after $k$ reaches $0$, the two variables have opposite signs.
%\newpage
Com o objetivo de recuperar esta propriedade, é proposta uma modificação na forma como $\theta$ é aplicada na lei de controle $u$ em (\ref{eq:u}). A nova proposta é dada por
%
\begin{equation}
  \theta_M = \theta^2k\,.
\end{equation}
%
Desta forma, tem-se que $sign(\theta_M) = sign(k)$. A Figura \ref{fig:dyntheta} ilustra os comportamentos de $\theta$ e $\theta_M$ para um ganho $k$ evoluindo do semi-plano positivo para o negativo.

\begin{figure}[htpb]
\centering
\def\JPicScale{0.57}%0.65
{\small
\begin{tabular}{cc}
\input{fig/evol1.pst}& \qquad \qquad 
\input{fig/evol2.pst}
\end{tabular}
}
\caption{Planos $\theta \times k$ e $\theta_M \times k$ (curvas típicas).}
\label{fig:dyntheta}
\end{figure}
%
%\begin{figure}[htpb]
%\centering
%\def\JPicScale{0.65}
%{\small
%\input{fig/evol2.pst}
%}
%\caption{Plano $\theta^2k \times k$ (curva típica).}
%\label{fig:dyntheta2}
%\end{figure}

A utilização da proposta modificada resulta no mapeamento de todo o eixo $\theta$ na origem do plano $\theta_M \times k$. Além disso, uma vez que os $2^o$ e $4^o$ quadrantes são mapeados nos $3^o$ e $1^o$ quadrantes, a hipérbole passa a representar também o lugar geométrico de $S = -2$. Note porém que para $S = -2$ e $k \neq 0$, $\dot{\theta} \neq 0$. Para o caso multivariável uma modificação similar é proposta. A matriz ${\boldsymbol \Theta}_M$ é dada por
%
\begin{equation}
  {\boldsymbol \Theta}_M = {\boldsymbol \Theta}\,{\boldsymbol \Theta}^T\,{\bf K}^T\,.
\end{equation}
%
Note que ${{\boldsymbol \Theta}\,{\boldsymbol \Theta}^T}$ é semi-definida positiva e simétrica. 
Considere o problema de controle dado pela equação $\dot{\bf e} = \dot{\bf y}_d - {\bf K}\,{\bf u}$ e a função de Lyapunov $2V_e = {\bf e}^T{\boldsymbol \Lambda}^T{\bf e}$. Sua derivada temporal ao longo das trajetórias do sistema é dada por $\dot{V}_e = {\bf e}^T{\boldsymbol \Lambda}^T(\dot{\bf y}_d - {\bf K}\,{\bf u})$. Assim, para ${\bf u} = {\bf u}_{M} = {\boldsymbol \Theta}\,{\boldsymbol \Theta}^T\,{\bf K}^T\,{\boldsymbol \nu}\,$, tem-se
%
\begin{equation}\label{eq:dVe}
  \dot{V}_e = {\bf e}^T{\boldsymbol \Lambda}^T\,({\bf I}_m - {\bf P}\,{\bf P}^T)\,\dot{\bf y}_d\, \underbrace{-\,{\bf e}^T{\boldsymbol \Lambda}^T\,{\bf P}\,{\bf P}^T{\boldsymbol \Lambda}\,{\bf e}}_{\Phi}\,,
\end{equation}
%
onde ${\bf P} = {\bf K}\,{\boldsymbol \Theta}$. O termo $\Phi$ corresponde a uma parcela semi-definida negativa, independente da qualidade da estimativa dada pelo algoritmo da inversa filtrada \eqref{eq:adapcomp}. 
%No caso onde ${\bf K}$ possui posto reduzido, o uso de ${\bf u}_{_{M}}({\boldsymbol \nu}) = {\boldsymbol \Theta}_M\,{\boldsymbol \nu}$ cancela as componentes de ${\boldsymbol \nu}$ no espaço nulo à esquerda de ${\bf K}$. Isto é, para ${\boldsymbol \nu} = {\boldsymbol \nu}_c + {\boldsymbol \nu}_n $, onde ${\boldsymbol \nu}_c \in Col({\bf K})$ e ${\boldsymbol \nu}_n \in Nul({\bf K}^T)$, tem-se ${\bf u}_{_{M}}({\boldsymbol \nu}) = {\bf u}_M({\boldsymbol \nu}_c)$. 
Assim, a proposta modificada para solução do problema de cinemática inversa é dada por
%
\begin{equation}
\label{eq::cinvmod}
\dot{\bf q}_M = {\boldsymbol \Theta}_M{\boldsymbol \nu} = {\boldsymbol \Theta}{\boldsymbol \Theta}^T{\bf J}^T{\boldsymbol \nu}, 
\end{equation}
% 
A relação entre as velocidades efetuada e demandada é então obtida:
%
\begin{equation}
\dot{\bf x} = \underbrace{{\bf J}{\boldsymbol \Theta}{\boldsymbol \Theta}^T{\bf J}^T}_{\bf M}{\boldsymbol \nu}.
\end{equation}
%
Note que ${\bf M} = {\bf M}^T \geq 0$, possuindo autovalores positivos ou nulos. Desta forma, velocidades demandadas nas direções dos autovetores de ${\bf M}$ resultam em velocidades efetuadas na mesma direção e sentido. 
% e, portanto, pode ser fatorada (SVD) como ${\bf M} = {\bf Q} {\boldsymbol \Sigma}_M {\bf Q}^T$. %Desta forma, velocidades demandadas nas direções das colunas de ${\bf Q}$ (autovetores de ${\bf M}$) resultam em velocidades efetuadas na mesma direção e sentido, com ajuste de amplitude definido pelos valores positivos da diagonal de ${\boldsymbol \Sigma}_M$ (. 
Assim, oscilações como as observadas na simulação \ref{sim::zebra_traj3} envolvendo a proposta inicial (\ref{eq::cinvini}) não serão observadas. No caso onde ${\bf J}$ possui posto reduzido, o uso de $\dot{\bf q}_{M}({\boldsymbol \nu}) = {\boldsymbol \Theta}_M\,{\boldsymbol \nu}$ cancela as componentes de ${\boldsymbol \nu}$ no espaço nulo à esquerda de ${\bf J}$. Isto é, para ${\boldsymbol \nu} = {\boldsymbol \nu}_c + {\boldsymbol \nu}_n $, onde ${\boldsymbol \nu}_c \in Col({\bf J})$ e ${\boldsymbol \nu}_n \in Nul({\bf J}^T)$, tem-se $\dot{\bf q}_{M}({\boldsymbol \nu}) = \dot{\bf q}_{M}({\boldsymbol \nu}_c)$. 

\begin{simulation}
\label{sim::zebra_mod}
\end{simulation}

\noindent Considere a mesma trajetória e os mesmos parãmetros da simulação \ref{sim::zebra_traj3}. No que se segue, é avaliado o desempenho da proposta modificada, apresentada em (\ref{eq::cinvini}), para trechos onde a posição desejada se torna inalcançável. As Figuras \ref{fig::zebramod_plane} e \ref{fig::zebramod_plane2} apresentam as trajetórias obtidas com o algoritmo DLS e a partir da proposta modificada para dois ganhos de atualização $\Gamma = \gamma{\bf I}$. 
%Como será visto, esta nova proposta permite que sinais de velocidade nas direções de pouca manipulabilidade sejam atenuados e oscilações de alta frequência nas variáveis de juntas não serão observadas.

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 3.2cm 1cm 2.7cm 0.5cm, scale = 0.49]{sim/zebra/mod/plane.eps}\\
%\includegraphics[trim = 3.2cm 0.5cm 2.7cm 0cm, scale = 0.49]{sim/zebra/mod/plane_amp.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_mod}: trajetórias no plano $xy$.}
\label{fig::zebramod_plane}
\end{figure}

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
%\includegraphics[trim = 3.2cm 1cm 2.7cm 0.8cm, scale = 0.49]{sim/zebra/mod/plane.eps}\\
\includegraphics[trim = 2.7cm 0.5cm 2.7cm 0cm, scale = 0.49]{sim/zebra/mod/plane_amp.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_mod}: trechos de transição no plano $xy$.}
\label{fig::zebramod_plane2}
\end{figure}

Para $\gamma = 1$, a solução obtida a partir da inversa filtrada é bastante similar à obtida pelo algoritmo DLS, apresentando um desvio considerável no momento em que a trajetória se torna novamente viável. Porém, nota-se que as variáveis $\dot{\bf q}$ obtidas com a inversa filtrada são mais suaves nos pontos de transição, notavelmente quando o manipulador se aproxima da singularidade (Figura \ref{fig::zebramod_dataq}). À medida que o manipulador se aproxima destas configurações, a convergência de ${\boldsymbol \Theta}$ torna-se mais lenta e os sinais de velocidade nas direções degeneradas são atenuados. %Como esperado, as oscilações de alta frequência nas variáveis de juntas não são observadas.

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0.3cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/mod/dq1.eps}\\
\includegraphics[trim = 2.7cm 0.3cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/mod/dq2.eps}\\
\includegraphics[trim = 2.7cm 0.3cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/mod/dq3.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_mod}: variáveis (a) $\dot{q_1}$; (b) $\dot{q_2}$; e (c) $\dot{q_3}$ ($\gamma = 1$).}
\label{fig::zebramod_dataq}
\end{figure}

\newpage
O ganho de atualização $\Gamma$ está diretamente relacionado ao desempenho do algoritmo e, para ganhos elevados ($\gamma = 25$), os desvios de trajetória em pontos de transição são pequenos, como mostrado na Figura \ref{fig::zebramod_plane2}. Nota-se também que as velocidades das juntas obtidas não apresentam alterações significativas em suas amplitudes (Figuras \ref{fig::zebramod_dataq} e \ref{fig::zebramod_dataq_25}), estando a principal alteração no instante de atuação. 

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0.2cm 2.7cm 0.05cm, scale = 0.49]{sim/zebra/mod/dq_25.eps}\\
\includegraphics[trim = 2.7cm 0.1cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/mod/dq_25_amp.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_mod} variáveis $\dot{\bf q}$ em (a) escala normal e (b) ampliada ($5<t<10$).}
\label{fig::zebramod_dataq_25}
\end{figure}

Como esperado, a convergência das matrizes de erro se torna mais rápida para ganhos de atualização maiores (Figura \ref{fig::zebramod_cond_25}.b). Desta forma, configurações de menor manipulabilidade são atingidas (Figura \ref{fig::zebramod_cond_25}.a). 

\begin{figure}[!htb]
\centering
\begin{tabular}{cc}
\includegraphics[trim = 2.7cm 0.3cm 2.7cm -0.42cm, scale = 0.49]{sim/zebra/mod/cond.eps}\\
\includegraphics[trim = 2.7cm 0.3cm 2.7cm 0.1cm, scale = 0.49]{sim/zebra/mod/vc.eps}\\
\end{tabular}
\caption{Simulação \ref{sim::zebra_mod} (a) número de condicionamento  e (b) função $V_c$ ($6<t<10$).}
\label{fig::zebramod_cond_25}
\end{figure}

